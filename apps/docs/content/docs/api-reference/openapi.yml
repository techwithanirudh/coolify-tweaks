openapi: 3.1.0
info:
  title: Coolify Tweaks API
  description: A lightweight Nitro server that serves `coolify-tweaks` release assets with optional TweakCN theme injection. It keeps the userstyle install links fast, consistent, and free from GitHub CDN hiccups.
  version: 1.0.0
  termsOfService: 'https://github.com/techwithanirudh/coolify-tweaks'
  contact:
    url: 'https://github.com/techwithanirudh/coolify-tweaks'
  license:
    name: MIT
    url: 'https://opensource.org/license/mit/'
servers:
  - url: 'https://api.coolify-tweaks.techwithanirudh.com'
    description: Production server
  - url: 'http://localhost:3001'
    description: Local development server
  - url: '{protocol}://{domain}'
    description: Custom Name
    variables:
      protocol:
        enum:
          - http
          - https
        default: http
      domain:
        description: Where your app run
        default: fumadocs.vercel.app

paths:
  /release/{tag}:
    get:
      summary: Get release asset
      description: Fetch a release asset from GitHub releases with optional theme injection. Defaults to `main.user.css` if no asset is specified. When a theme is provided, CSS variables from TweakCN are injected into the userstyle.
      operationId: getReleaseAsset
      tags:
        - Releases
      parameters:
        - $ref: '#/components/parameters/ReleaseTag'
        - $ref: '#/components/parameters/AssetName'
        - $ref: '#/components/parameters/ThemeId'
      responses:
        '200':
          description: Successfully retrieved release asset.
          content:
            text/css:
              schema:
                $ref: '#/components/schemas/CssContent'
              examples:
                default_css:
                  $ref: '#/components/examples/CssResponseExample'
                themed_css:
                  $ref: '#/components/examples/ThemedCssResponseExample'
            application/octet-stream:
              schema:
                type: string
                format: binary
              description: Binary asset file (e.g., zip archives)
          headers:
            X-Proxy-Host:
              schema:
                type: string
                example: github.com
            ETag:
              schema:
                type: string
            Last-Modified:
              schema:
                type: string
            X-RateLimit-Remaining:
              schema:
                type: integer
            X-RateLimit-Limit:
              schema:
                type: integer
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /health:
    get:
      summary: Health check
      description: Returns service status information for monitoring.
      operationId: getHealth
      tags:
        - Operations
      responses:
        '200':
          description: Service is healthy.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'
              examples:
                default_example:
                  $ref: '#/components/examples/HealthResponseExample'
  /:
    get:
      summary: API information
      description: Returns basic information about the API service.
      operationId: getApiInfo
      tags:
        - Operations
      responses:
        '200':
          description: API information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiInfo'
              examples:
                default_example:
                  $ref: '#/components/examples/ApiInfoResponseExample'

components:
  schemas:
    ReleaseTag:
      description: Release tag identifier. Use `latest` for the most recent release, or a specific version tag like `v3.8.10`.
      type: string
      example: latest
    AssetName:
      description: Name of the asset file to retrieve from the release. Defaults to `main.user.css` if not specified.
      type: string
      example: main.user.css
    ThemeId:
      description: TweakCN theme identifier for CSS variable injection. Only applies when requesting `main.user.css`.
      type: string
      pattern: '^c[a-z0-9]{24}$'
      example: c1234567890abcdefghijklmn
    CssContent:
      description: CSS content with optional theme variables injected.
      type: string
      contentMediaType: text/css
    HealthStatus:
      type: object
      properties:
        status:
          type: string
          enum:
            - ok
          example: ok
        message:
          type: string
          example: Server is running
        timestamp:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00.000Z'
      required:
        - status
        - message
        - timestamp
    ApiInfo:
      type: object
      properties:
        service:
          type: string
          example: Coolify Tweaks API
        description:
          type: string
          example: Proxies GitHub release assets for Coolify Tweaks
        version:
          type: string
          example: '1.0'
      required:
        - service
        - description
        - version
    Error:
      type: object
      properties:
        statusCode:
          type: integer
          example: 400
        statusMessage:
          type: string
          example: Bad Request
        message:
          type: string
          example: Invalid input
        data:
          type: object
          additionalProperties: true
          example:
            field: tag

  parameters:
    ReleaseTag:
      name: tag
      in: path
      description: Release tag identifier. Use `latest` for the most recent release, or a specific version tag.
      required: true
      schema:
        $ref: '#/components/schemas/ReleaseTag'
    AssetName:
      name: asset
      in: query
      description: Asset filename to retrieve. Defaults to `main.user.css` if not specified.
      required: false
      schema:
        $ref: '#/components/schemas/AssetName'
    ThemeId:
      name: theme
      in: query
      description: TweakCN theme identifier for CSS variable injection. Only applies when requesting `main.user.css`. Browse available themes at https://tweakcn.com/themes.
      required: false
      schema:
        $ref: '#/components/schemas/ThemeId'

  examples:
    CssResponseExample:
      summary: Default CSS response
      value: |
        /* ==UserStyle==
        @name           Coolify Tweaks
        @namespace      github.com/techwithanirudh/coolify-tweaks
        @version        3.8.10
        @description    Enhancements for Coolify
        @author         techwithanirudh
        @updateURL      https://api.coolify-tweaks.techwithanirudh.com/release/latest/
        ==/UserStyle== */

        :root {
          --primary-color: #3b82f6;
        }
    ThemedCssResponseExample:
      summary: CSS with theme injection
      value: |
        /* ==UserStyle==
        @name           Coolify Tweaks
        @namespace      github.com/techwithanirudh/coolify-tweaks
        @version        3.8.10
        @description    Enhancements for Coolify
        @author         techwithanirudh
        @updateURL      https://api.coolify-tweaks.techwithanirudh.com/release/latest/?theme=c1234567890abcdefghijklmn
        ==/UserStyle== */

        /* ==UI-THEME-VARS:START== */

        :root {
          --background: 0 0% 100%;
          --foreground: 222.2 84% 4.9%;
        }

        .dark {
          --background: 222.2 84% 4.9%;
          --foreground: 210 40% 98%;
        }

        /* ==UI-THEME-VARS:END== */

        :root {
          --primary-color: #3b82f6;
        }
    HealthResponseExample:
      summary: Health check response
      value:
        status: ok
        message: Server is running
        timestamp: '2024-01-15T10:30:00.000Z'
    ApiInfoResponseExample:
      summary: API information response
      value:
        service: Coolify Tweaks API
        description: Proxies GitHub release assets for Coolify Tweaks
        version: '1.0'

  responses:
    BadRequest:
      description: Bad request. Invalid parameters provided.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            statusCode: 400
            statusMessage: Bad Request
            message: Invalid input
            data:
              field: tag
    NotFound:
      description: Resource not found. The release tag, asset, or theme does not exist.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            statusCode: 404
            statusMessage: Not Found
            message: 'Theme not found: invalid-theme-id'
            data:
              url: https://github.com/techwithanirudh/coolify-tweaks/releases/download/latest/main.user.css
              tag: latest
    InternalServerError:
      description: Internal server error. An error occurred while processing the request.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            statusCode: 500
            statusMessage: Internal Server Error
            message: Unknown error
            data:
              url: https://github.com/techwithanirudh/coolify-tweaks/releases/download/latest/main.user.css
              tag: latest

tags:
  - name: Releases
    description: Endpoints for retrieving GitHub release assets with optional theme injection.
  - name: Operations
    description: Operational endpoints for monitoring and API information.

