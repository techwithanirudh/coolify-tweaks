/* ==UserStyle==
@name         Coolify Enhanced UI (light + dark via .dark)
@namespace    techwithanirudh
@version      1.6
@preprocessor stylus
@include      *://coolify.local/* https://app.coolify.io/*
@updateURL    https://github.com/techwithanirudh/coolify-tweaks/raw/main/tweaks.user.styl
@author       Anirudh Sriram
@license      MIT
==/UserStyle== */

/* ONE @-moz-document with a comma between the two url-prefixes */
@-moz-document url-prefix("*://coolify.local/"),
               url-prefix("https://app.coolify.io")

  /* ───────── 0.  MIXINS ───────── */
  reset()
    border none !important
    box-shadow none !important
    border-radius var(--cfy-radius) !important

  scrollbar(w,c)
    &::-webkit-scrollbar
      width w
      height w
    &::-webkit-scrollbar-thumb
      background c
      border-radius 4px

  /* ───────── 1.  GLOBAL TOKENS ───────── */
  accent              = #4C3495
  radius              = 12px
  blurAmt             = 12px
  sidebarW            = 230px

  /* Colours that drive BOTH themes so they keep the same visual weight */
  white100            = #ffffff
  white90             = #f5f5f7
  white80             = #fafafa
  white70             = #f3f3f4
  black100            = #1a1a1f
  grayMutedL          = #6c6a70
  grayMutedD          = #8E8C91
  grayDarker          = #26252B
  grayDarkest         = #1F1C23

  /* Scrollbar tones pre‑computed here so Stylus can safely darken/lighten */
  scrollbarLight      = #c2c2c2
  scrollbarLightHover = darken(scrollbarLight, 15%) /* #a8a8a8 */
  scrollbarDark       = #444444
  scrollbarDarkHover  = lighten(scrollbarDark, 15%) /* #666666 */

  /* ───────── 2.  LIGHT THEME (default) ───────── */
  :root
    /* palette */
    --cfy-accent               accent
    --cfy-accent-light         unquote('color-mix(in srgb, var(--cfy-accent) 75%, #000)')

    /* surfaces */
    --cfy-sidebar-bg           white100
    --cfy-secondary            white90
    --cfy-content-bg           white80
    --cfy-card-container       white70
    --cfy-card                 white100
    --cfy-card-hover           mix(white100, accent, 8%)

    /* text */
    --cfy-text                 black100
    --cfy-muted                grayMutedL

    /* borders & shadows */
    --cfy-border               rgba(0,0,0,.06)
    --cfy-shadow               0 4px 20px rgba(0,0,0,.12)

    /* interactive */
    --cfy-input-bg             white100
    --cfy-input-bg-focus       white90
    --cfy-scrollbar            scrollbarLight
    --cfy-scrollbar-hover      scrollbarLightHover

    /* layout */
    --cfy-radius               radius
    --cfy-blur                 blurAmt
    --cfy-sidebar-w            sidebarW

    color-scheme               light
    font-size                  15px

  /* ───────── 3.  DARK THEME OVERRIDES ───────── */
  html.dark :root
    --cfy-sidebar-bg           #1A191F
    --cfy-secondary            grayDarker
    --cfy-content-bg           grayDarkest
    --cfy-card-container       #2A292E
    --cfy-card                 #353239
    --cfy-card-hover           unquote('color-mix(in srgb, var(--cfy-card) 70%, var(--cfy-accent) 30%)')

    --cfy-text                 #FCFAFC
    --cfy-muted                grayMutedD

    --cfy-accent-light         unquote('color-mix(in srgb, var(--cfy-accent) 25%, #000)')

    --cfy-border               #ffffff1a
    --cfy-shadow               0 4px 20px rgba(0,0,0,.30)

    --cfy-input-bg             #202024
    --cfy-input-bg-focus       #26262b
    --cfy-scrollbar            scrollbarDark
    --cfy-scrollbar-hover      scrollbarDarkHover

    color-scheme               dark

  /* ───────── 4.  GLOBAL RESET ───────── */
  body,
  .box, .card, .menu-item,
  button, a, input, select, textarea
    reset()

  body, main
    background var(--cfy-content-bg) !important
    color       var(--cfy-text)

  /* ───────── 5.  SIDEBAR ───────── */
  [class*="lg:flex"][class*="lg:w-56"]
    width var(--cfy-sidebar-w) !important

  nav[class*="dark:border-coolgray-200"]
    width 100%
    background var(--cfy-sidebar-bg) !important
    backdrop-filter blur(var(--cfy-blur))
    -webkit-backdrop-filter blur(var(--cfy-blur))
    border-right 1px solid var(--cfy-border)
    overflow-y auto !important
    overflow-x hidden
    scrollbar-width thin
    scrollbar-color var(--cfy-scrollbar) transparent
    scrollbar(8px, var(--cfy-scrollbar))

  nav > ul > li > ul > li
    border-radius var(--cfy-radius) !important
    overflow hidden

  .menu-item
    display flex
    align-items center
    gap .6rem
    padding .55rem .9rem
    font-weight 500
    color var(--cfy-muted)
    transition background .18s, color .18s
    &:hover,
    &-active
      background var(--cfy-accent-light)
      color var(--cfy-text) !important
    svg
      width 20px
      height 20px
      stroke-width 1.6
      flex-shrink 0

  @media (max-width:1023px)
    aside[class*="sidebar"]
      position fixed
      inset 0
      transform translateX(calc(-1 * var(--cfy-sidebar-w)))
      z-index 60
      transition transform .25s ease
    body.sidebar-open
      aside
        transform none
      &::after
        content ""
        position fixed
        inset 0
        background rgba(0,0,0,.55)
        z-index 50

  @media (min-width:1024px)
    main
      padding-left var(--cfy-sidebar-w) !important

  /* ───────── 6.  TOP NAV ───────── */
  .navbar-main
    position sticky
    top 0
    z-index 45
    padding .45rem .85rem
    background var(--cfy-sidebar-bg)
    backdrop-filter blur(var(--cfy-blur))
    -webkit-backdrop-filter blur(var(--cfy-blur))
    border 1px solid var(--cfy-border)
    border-radius var(--cfy-radius) !important
    nav
      display flex
      gap .8rem
      &::-webkit-scrollbar
        display none
      button
        all unset
        cursor pointer
        padding .55rem 1.25rem
        font-weight 600
        color var(--cfy-muted)
        transition background .18s, color .18s
        &:hover
          background var(--cfy-accent-light)
          color var(--cfy-text)
      a[aria-current="page"] button,
      a.active button
        background var(--cfy-accent)
        color var(--cfy-text)
        box-shadow inset 0 0 0 2px var(--cfy-accent-light)
    .flex-1
      flex 1 1 auto

  /* ───────── 7.  CARDS & GRIDS ───────── */
  section > h2 + div,
  section > h3 + div,
  div[data-testid="resources-grid"],
  div[class*="grid-cols"]
    padding .75rem .85rem !important
    background var(--cfy-card-container) !important
    border-radius var(--cfy-radius) !important
    overflow hidden
    margin-top .65rem

  .grid,
  [class*="grid-cols"]
    gap .65rem !important

  .box,
  .box-without-bg
    padding .65rem .75rem
    background var(--cfy-card) !important
    border 1px solid transparent
    box-shadow var(--cfy-shadow) !important
    transition transform .15s, box-shadow .2s, background .18s, border-color .18s
    border-radius var(--cfy-radius) !important
    &:hover
      transform translateY(-2px)
      box-shadow 0 8px 24px rgba(0,0,0,.35)
      border-color var(--cfy-accent)
      background var(--cfy-card-hover)

  [dashed],
  [class*="dashed"]
    padding-block 2rem !important
    border-radius var(--cfy-radius) !important
    border-color var(--cfy-border) !important

  [role="row"]:not([dashed])
    background var(--cfy-card) !important
    border-radius var(--cfy-radius) !
