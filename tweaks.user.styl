/* ==UserStyle==
@name         Coolify Enhanced UI
@namespace    techwithanirudh
@version      1.3
@preprocessor stylus
@description  Extra spacing, rounded corners & subtle shadows for Coolify
@include      *://coolify.local/* https://app.coolify.io/*
@updateURL    https://github.com/techwithanirudh/coolify-tweaks/raw/main/tweaks.user.styl
@author       Anirudh Sriram
@license      MIT
==/UserStyle== */

/*  ↓↓↓  just one comma added after the first url-prefix()  */
@-moz-document url-prefix("*://coolify.local/"),
               url-prefix("https://app.coolify.io")

  /* ───────────────── 1. DESIGN TOKENS ───────────────── */
  accent          = #4C3495
  accentLight     = mix(#fff, accent, 25%)
  sidebarBG       = #1A191F
  secondary       = #26252B
  contentBG       = #1F1C23
  cardContainer   = #2A292E
  card            = #353239
  cardHover       = mix(card, accent, 30%)
  textCol         = #FCFAFC
  mutedCol        = #8E8C91

  radius          = 12px
  blurAmt         = 12px
  baseShadow      = 0 4px 20px rgba(0,0,0,.25)
  sidebarW        = 230px

  /* export as CSS variables */
  :root
    {--cfy-accent}           accent
    {--cfy-accent-light}     accentLight
    {--cfy-sidebar-bg}       sidebarBG
    {--cfy-secondary}        secondary
    {--cfy-content-bg}       contentBG
    {--cfy-card-container}   cardContainer
    {--cfy-card}             card
    {--cfy-card-hover}       cardHover
    {--cfy-text}             textCol
    {--cfy-muted}            mutedCol
    {--cfy-radius}           radius
    {--cfy-blur}             blurAmt
    {--cfy-shadow}           baseShadow
    {--cfy-sidebar-w}        sidebarW
    font-size 15px
    color-scheme dark

  /* ───────── mixins ───────── */
  reset()
    border none !important
    box-shadow none !important
    border-radius radius !important

  scrollbar(w,c)
    &::-webkit-scrollbar
      width w
      height w
    &::-webkit-scrollbar-thumb
      background c
      border-radius 4px

  /* global reset */
  body, .box, .card, .menu-item, button, a, input, select, textarea
    reset()

  body, main
    background contentBG !important
    color textCol

  /* sidebar */
  [class*="lg:flex"][class*="lg:w-56"]
    width sidebarW !important

  nav[class*="dark:border-coolgray-200"]
    width 100%
    background sidebarBG !important
    backdrop-filter blur(blurAmt)
    -webkit-backdrop-filter blur(blurAmt)
    border-right 1px solid #ffffff10
    overflow-y auto !important
    overflow-x hidden
    scrollbar-width thin
    scrollbar-color accent transparent
    scrollbar(8px, accent)

  nav > ul > li > ul > li
    border-radius radius !important
    overflow hidden

  .menu-item
    display flex
    align-items center
    gap .6rem
    padding .55rem .9rem
    font-weight 500
    color mutedCol
    transition background .18s, color .18s

    &:hover,
    &-active
      background accentLight
      color #fff !important

    svg
      width 20px
      height 20px
      stroke-width 1.6
      flex-shrink 0

  @media (max-width:1023px)
    aside[class*="sidebar"]
      position fixed
      inset 0
      transform translateX(-sidebarW)
      z-index 60
      transition transform .25s ease

    body.sidebar-open
      aside
        transform none
      &::after
        content ""
        position fixed
        inset 0
        background #0009
        z-index 50

  @media (min-width:1024px)
    main
      padding-left sidebarW !important

  /* top sub-nav */
  .navbar-main
    position sticky
    top 0
    z-index 45
    padding .45rem .85rem
    background sidebarBG
    backdrop-filter blur(blurAmt)
    -webkit-backdrop-filter blur(blurAmt)
    border 1px solid #ffffff10
    border-radius radius !important

    nav
      display flex
      align-items center
      gap .8rem
      padding-top 0 !important
      &::-webkit-scrollbar
        display none

      button
        all unset
        cursor pointer
        padding .55rem 1.25rem
        font-weight 600
        color mutedCol
        transition background .18s, color .18s

        &:hover
          background accentLight
          color #111

      a[aria-current="page"] button,
      a.active button
        background accent
        color #111
        box-shadow inset 0 0 0 2px accentLight

    .flex-1
      flex 1 1 auto

  /* containers & cards */
  section > h2 + div,
  section > h3 + div,
  div[data-testid="resources-grid"],
  div[class*="grid-cols"]
    padding .75rem .85rem !important
    background cardContainer !important
    border-radius radius !important
    overflow hidden
    margin-top .65rem

  .grid,
  [class*="grid-cols"]
    gap .65rem !important

  .box,
  .box-without-bg
    padding .65rem .75rem
    background card !important
    border 1px solid transparent
    box-shadow baseShadow !important
    transition transform .15s, box-shadow .2s, background .18s, border-color .18s
    border-radius radius !important

    &:hover
      transform translateY(-2px)
      box-shadow 0 8px 24px rgba(0,0,0,.35)
      border-color accent
      background cardHover

  [dashed],
  [class*="dashed"]
    padding-block 2rem !important
    border-radius radius !important
    border-color #555 !important

  [role="row"]:not([dashed])
    background card !important
    border-radius radius !important
    padding .6rem .8rem

  /* ───────── 5. TYPOGRAPHY ───────── */
  headingSizes = 2.1rem 1.5rem 1.25rem 1.1rem

  for size, i in headingSizes          // i = 0..3 -> h1..h4
    lvl = i + 1
    h{lvl}
      font-weight 700
      font-size   size
      line-height 1.3                 // pick a sane ratio
      font-family "Inter", "SF Pro Display", sans-serif
      color textCol

  .subtitle
    font-size .95rem
    color mutedCol

  .box-title
    font-size 1.05rem
    font-weight 600

  .box-description
    color mutedCol

  /* buttons */
  button.button,
  .button
    background accent
    color #fafafa !important
    font-weight 600
    padding .75rem 1rem
    border 1px solid #ffffff1a !important
    border-radius radius
    transition background .18s

    &:hover
      background accentLight
      color #111 !important

  button.secondary,
  .secondary
    background secondary !important
    color textCol !important

    &:hover
      background cardContainer !important

  /* form controls */
  input.input,
  textarea.input,
  select.select
    background #202024 !important
    border 1px solid #ffffff1a !important
    color textCol
    padding .75rem 1rem
    border-radius radius !important
    transition border-color .15s, background .15s

    &:focus
      border-color accentLight !important
      background #26262b !important

  /* toasts */
  ul[x-data] li > span
    backdrop-filter blur(blurAmt)
    background hsla(0,0%,100%,.05) !important
    border 1px solid #ffffff18 !important
    font-family "Inter", sans-serif

  @keyframes wiggle
    from
      transform rotate(0)
    25%
      transform rotate(-3deg)
    75%
      transform rotate(3deg)
    to
      transform rotate(0)

  .toast-no-description svg[fill="currentColor"]
    animation wiggle .6s ease

  [x-show="popups.sponsorship"]
    display none !important

  /* scrollbar */
  ::-webkit-scrollbar
    width 8px
    height 8px

  ::-webkit-scrollbar-thumb
    background #444
    border-radius 4px

    &:hover
      background #666

  /* focus ring */
  button:focus-visible,
  a:focus-visible,
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible
    outline 2px solid accent !important
    outline-offset 2px
